"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20588],{674133:(e,t,r)=>{r.d(t,{$N:()=>d,T9:()=>m,dm:()=>C,fd:()=>p,wq:()=>h,zM:()=>f});var a=r(406029),s=r(455729),l=r(777011),n=r(531977),i=r(443331),o=r(364537),u=r(631363),c=r(932014);let d=e=>e.nodes[e.root]?.config?.storyLocale,h=async e=>{{let{setLocale:t}=await Promise.all([r.e(96975),r.e(84398),r.e(98546)]).then(r.bind(r,698546));t(e??window.document.documentElement.lang??"en")}},f=async(e,t)=>{let r=t||window?.document?.documentElement?.lang||"en-us",a=`${(0,i.mZ)(e)}/portals/regions?f=json&culture=${r}`;return await (0,l.Em)(a,{httpMethod:"GET"})},p=e=>e.map((e,t)=>({id:t,labelId:"",label:e.localizedName,searchModifier:"",iSearchOptions:{categories:`/Region/${e.region}`}})),m=e=>{let{authManager:t}=(0,n.Py)(),r=(0,o.UK)(),{allSupportedLanguages:a}=(0,c.Ut)(),[l,d]=(0,s.useState)(),h=(0,i.mZ)(r.PORTAL_HOST,t),f=(0,s.useMemo)(()=>new Set(e?.supportedLocales?.map(e=>(0,u.KN)(e,a))??[]),[e?.supportedLocales,a]);return(0,s.useEffect)(()=>{(async()=>{if(h)try{let e=await (0,u.Ar)(h);d(e)}catch(e){console.error(e)}})()},[h]),(0,s.useMemo)(()=>l?f.size?l.filter(e=>{let t=(0,u.KN)(e.culture,a);return f.has(t)}):l:void 0,[l,f,a])},C=(e,t)=>r=>{let s=m(t);return(0,a.jsx)(e,{portalLanguages:s,...r})}},692049:(e,t,r)=>{r.d(t,{$m:()=>o,Pg:()=>n,TG:()=>i});var a=r(406029),s=r(455729);let l=(0,s.createContext)({areLabFeaturesEnabled:!1}),n=()=>(0,s.useContext)(l).areLabFeaturesEnabled,i=e=>{let{children:t,areLabFeaturesEnabled:r}=e;return(0,a.jsx)(l.Provider,{value:{areLabFeaturesEnabled:r},children:t})},o=e=>t=>(0,a.jsx)(l.Consumer,{children:r=>(0,a.jsx)(e,{...t,...r})})},820588:(e,t,r)=>{r.d(t,{c:()=>w});var a=r(406029),s=r(692049),l=r(337139),n=r(852701),i=r(564715),o=r(455729),u=r(902776);class c extends o.PureComponent{constructor(e){super(e),this.updateStoryOffsetContext=(e,t)=>{t?this.setState({...e,updateStoryOffsetContext:this.updateStoryOffsetContext}):this.setState(t=>({...t,...e,updateStoryOffsetContext:this.updateStoryOffsetContext}))},this.state={updateStoryOffsetContext:this.updateStoryOffsetContext,storyOffset:{navBarHeight:"0rem"}}}render(){return(0,a.jsx)(u.i.Provider,{value:this.state,children:this.props.children})}}var d=r(647682),h=r(531977),f=r(658600),p=r(364537),m=r(111970),C=r(725881),y=r(628762),S=r(307557),g=r(443331),x=r(674133),b=r(35068);function w(e){let{areLabFeaturesEnabled:t=!1,children:r,storyItem:u}=e,w=(({itemDetails:e})=>{let t=(0,x.T9)(),[r,a]=(0,o.useState)(),[s,l]=(0,o.useState)(),[n,i]=(0,o.useState)(),[u,c]=(0,o.useState)(!1),[w,L]=(0,o.useState)(!1),[T,v]=(0,o.useState)(!0),{authManager:O}=(0,h.Py)(),P=(0,b.A)(),j=(0,p.UK)(),k=e=>e?.find(e=>e.startsWith(f.cC.hasTranslation)),E=(0,o.useCallback)(e=>{i(n?.filter(t=>e.includes(t.id)))},[n]),I=(0,o.useCallback)(()=>{E(s?.map(e=>e.id)||[])},[E,s]),A=(0,o.useCallback)(e=>{a(r?.filter(t=>!e.includes(t.id)))},[r]),K=(0,o.useCallback)(r=>r.map(r=>{let a=r.culture??"en-us",s=k(r.typeKeywords),l=e?.properties?.allowedTranslations?.includes(r.id),n=t?.find(e=>{let t=a;return"en-ca"===t&&(t="en"),t.includes(e.culture.toLowerCase())}),i=`${n?.localizedName} - ${n?.language}`,o=s===f.cC.hasTranslation,u=o?`${i} (${P("viewer.languageSettings.languageIsSource")})`:i;return{id:r.id,culture:a,label:u,title:r.title,isSourceItem:o,itemType:(0,m.EN)(r),hasDetachedFromSource:!s&&l}}),[P,e?.properties?.allowedTranslations,t]),$=(0,o.useCallback)(async(e,t)=>{if(t&&n)return n;if(!e||0===e.length)return[];try{let t=await (0,C.Lc)({filter:y.b.fetchAllPublicySharedPublishedStoriesByIds(e),authentication:O}),r=K(t.results);return i(e=>{if(e){let t=r.filter(t=>!e.some(e=>e.id===t.id));return[...e,...t]}return r}),r}catch(e){return L(!0),v(!1),[]}},[n,O,K]),N=(0,o.useCallback)(async()=>{if(L(!1),!e?.id||!e?.typeKeywords||(0,S.m5)(e))return void v(!0);if(!r){if(v(!0),!t)return;let r=[],s=k(e?.typeKeywords),n=s===f.cC.hasTranslation||!s;c(n);try{let t;if(n)r=[...e.properties?.allowedTranslations??[]];else{let e=s?.split(":")[1]??"";r=[...(await (0,d.Gq)(e,{authentication:O,portal:(0,g.mZ)(j.PORTAL_HOST)})).properties.allowedTranslations,e]}r.length>0&&(t=await (0,C.Lc)({filter:y.b.fetchAllPublicySharedPublishedStoriesByIds(r),portal:(0,g.mZ)(j.PORTAL_HOST)}));let i=[...t?.results??[]];n&&(i=[...i,e]);let o=K(i);return o.length>0&&(a(o),l(o)),L(!1),v(!1),o}catch(e){return L(!0),v(!1),e.response}}},[e,r,t,K,O,j.PORTAL_HOST]);return(0,o.useEffect)(()=>{let e;try{"requestIdleCallback"in window?e=requestIdleCallback(()=>{N()}):N()}catch(e){L(!0),v(!1),console.error("Error fetching supported languages:",e)}return()=>{e&&cancelIdleCallback(e)}},[N]),{supportedLanguages:r,refetchLanguages:N,resetToPublished:I,fetchAddedTranslations:$,resetAddedTranslationLanguagesToDraft:E,removeSupportedTranslations:A,addedTranslationsLanguages:n,isLoading:T,isError:w,isSourceItem:u}})({itemDetails:u?.itemDetails});return(0,a.jsx)(s.TG,{areLabFeaturesEnabled:t,children:(0,a.jsx)(l.AK,{storyItem:u,children:(0,a.jsx)(c,{children:(0,a.jsx)(n.ZL,{multiLang:w,children:(0,a.jsx)(i.Y,{children:r})})})})})}},852701:(e,t,r)=>{r.d(t,{X3:()=>n,ZK:()=>o,ZL:()=>i});var a=r(406029),s=r(455729);let l=(0,s.createContext)({}),n=()=>(0,s.useContext)(l),i=e=>{let{children:t,...r}=e;return(0,a.jsx)(l.Provider,{value:r.multiLang,children:t})},o=e=>t=>(0,a.jsx)(l.Consumer,{children:r=>(0,a.jsx)(e,{...t,multiLang:r})})},902776:(e,t,r)=>{r.d(t,{S:()=>l,i:()=>s});var a=r(455729);let s=(0,a.createContext)({updateStoryOffsetContext:()=>{},storyOffset:{navBarHeight:"0rem"}}),l=()=>(0,a.useContext)(s)},932014:(e,t,r)=>{r.d(t,{Ut:()=>l}),r(406029);var a=r(455729);let s=(0,a.createContext)({translateContentIntoLocale:()=>void 0,submitTranslationFeedback:()=>void 0,allSupportedLanguages:[]}),l=()=>(0,a.useContext)(s)}}]);