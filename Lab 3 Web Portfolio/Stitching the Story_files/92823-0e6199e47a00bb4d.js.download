"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92823],{992823:(e,t,r)=>{r.d(t,{NV:()=>I,_H:()=>P,LD:()=>N,eb:()=>C,bO:()=>z,hk:()=>F,Ni:()=>k,k9:()=>_,eD:()=>x,V4:()=>S});var a=r(406029);r(455729);var i=r(390248),s=r(647682),o=r(307557),n=r(724875),m=r(95206),l=r(343942),h=r(301972),d=r(9736),c=r(695505),p=r(443331),u=r(650557),y=r(111970),g=r(501411),w=r(718230),f=r(52457),T=r(249555),A=r(183581),b=r(128456),v=r(581797),$=r(811579);let C=async e=>{try{await (0,o.wS)({isFavorite:!0,itemId:e.id,authManager:e.authManager,owner:e.owner}),e.toast.add({type:"success",title:(0,a.jsx)(i.A,{id:"itemUtils.addFavorite.success"})})}catch(t){throw e.toast.add({type:"error",title:(0,a.jsx)(i.A,{id:"builder.common.sorry"}),details:(0,a.jsx)(i.A,{id:"itemUtils.addFavorite.error"})}),Error(t)}},S=async e=>{try{await (0,o.wS)({isFavorite:!1,itemId:e.id,authManager:e.authManager,owner:e.owner}),e.toast.add({type:"success",title:(0,a.jsx)(i.A,{id:"itemUtils.removeFavorite.success"})})}catch(t){throw e.toast.add({type:"error",title:(0,a.jsx)(i.A,{id:"builder.common.sorry"}),details:(0,a.jsx)(i.A,{id:"itemUtils.removeFavorite.error"})}),Error(t)}},N=async e=>{let t,r=(0,a.jsx)(i.A,{id:"component.deleteItem.toast.title.permanent"});e.isRecycleBinEnabled&&!e.isPermanent&&(r=(0,a.jsx)(i.A,{id:"component.deleteItem.toast.title.recoverable"}),t=(0,a.jsx)(i.A,{id:"component.deleteItem.toast.description.recoverable"}));try{await (0,s.Ai)({authentication:e.authManager,id:e.id,...e.owner&&{owner:e.owner},params:e.isPermanent?{permanentDelete:!0}:{}}),e.toast.add({type:"success",title:r,details:t})}catch(t){throw e.toast.add({type:"error",title:(0,a.jsx)(i.A,{id:"builder.common.sorry"}),details:(0,a.jsx)(i.A,{id:"itemUtils.errorDeleting.item"})}),Error(t)}},E=e=>{switch(e.itemType){case n.z.Story:{if(e.isTemplate){m.A.trackEvent(m.A.Category.Story,m.A.Action.Story_CreateNewStoryTemplate);break}let t={sidecar:m.A.Name.QuickStartTemplate_Sidecar,"guided-tour":m.A.Name.QuickStartTemplate_GuidedTour,explorer:m.A.Name.QuickStartTemplate_Explorer},r=(0,$.fO)(e.templateForStory)?t[e.templateForStory]:m.A.Name.QuickStartTemplate_Default;r&&m.A.trackEvent(m.A.Category.Story,m.A.Action.Story_CreateNewStory,r),e.hasThemeForStory&&m.A.trackEvent(m.A.Category.Story,m.A.Action.Story_CreateNewStoryWithTheme);break}case n.z.Briefing:m.A.trackEvent(m.A.Category.Briefing,m.A.Action.Briefing_CreateBriefing);break;case n.z.Frame:m.A.trackEvent(m.A.Category.Frame,m.A.Action.Frame_CreateFrame);break;case n.z.Collection:m.A.trackEvent(m.A.Category.Collection,m.A.Action.Collection_CreateCollection);break;case n.z.Theme:m.A.trackEvent(m.A.Category.Theme,m.A.Action.Theme_CreateNewTheme)}},I=async e=>{let t=await (0,l.HK)(e.authManager),r=await (0,b.q_)(e.config.BASE_URL),a=await e.authManager.getUser(),i=await (0,s.wE)({authentication:e.authManager,params:{thumbnail:r},item:(0,b.Qe)({itemType:e.itemType,config:e.config,isPublicUser:t,orgId:a.orgId,isTemplate:e.isTemplate})}),o=(()=>{switch(e.itemType){case n.z.Story:return(0,b.ou)({firstName:a.firstName,lastName:a.lastName,title:e.title,theme:e.theme,baseThemeId:e.baseThemeId,webmap:e.webmap,webscene:e.webscene,template:e.template,shouldIncludeAuthorCard:e.featureDecisions.canUseAuthorCard,coverType:e.config.INCLUDED_STORY_COVERS[0],isTemplate:e.isTemplate});case n.z.Briefing:return(0,b.Jk)({firstName:a.firstName,lastName:a.lastName,title:e.title,theme:e.theme,baseThemeId:e.baseThemeId,coverType:e.config.INCLUDED_STORY_COVERS[0]});case n.z.Frame:return(0,b.k4)({firstName:a.firstName,lastName:a.lastName,title:e.title,theme:e.theme,baseThemeId:e.baseThemeId,coverType:e.config.INCLUDED_STORY_COVERS[0]});case n.z.Collection:return(0,b.Dr)({firstName:a.firstName,lastName:a.lastName,title:e.title,theme:e.theme,baseThemeId:e.baseThemeId});case n.z.Theme:return(({baseThemeId:e})=>{let{defaultBaseVariables:t}=(0,v.ao)(e),r={...t};return delete r.colorRamps,{baseThemeId:e,variables:r}})({baseThemeId:e.baseThemeId});default:return{}}})();return e.itemType===n.z.Story&&e.theme&&(await (0,s.xg)({originItemId:e.theme,destinationItemId:i.id,relationshipType:h.wx,authentication:e.authManager}),m.A.trackEvent(m.A.Category.Theme,m.A.Action.Theme_AddRelationshipTheme2Story)),await (0,s.zk)({authentication:e.authManager,id:i.id,name:"draft.json",resource:(0,d.YX)(o),owner:e.authManager.username,private:!0}),e.itemType===n.z.Story?E({itemType:e.itemType,templateForStory:e.template,hasThemeForStory:!!e.theme,isTemplate:e.isTemplate}):E({itemType:e.itemType,isTemplate:e.isTemplate}),i},k=e=>{let{storyUrl:t,getUrlFromRouteDef:r}=e;return r({route:"report-abuse",storyUrl:(0,c.wz)(t||window.location.href,["play","speed","cover","header"])})},x=e=>{let{itemId:t,portalHost:r,authManager:a,customTracker:i}=e;try{let e=(e=>window.performance.getEntriesByType("resource").filter(t=>"string"==typeof e?t.name===e:e.test(t.name)))(RegExp(`sharing/rest/content/items/${t}/data`)),o=window.performance.now(),n=e.reduce((e,t)=>{let r=o-t.startTime;return Math.min(r,e)},1/0);(0===e.length||isFinite(n)&&n>9999)&&(0,u.E4)(()=>{(0,s.MB)(t,{authentication:a,portal:(0,p.mZ)(r,a)}),i?.()},void 0,3e3)}catch{}},_=(e,t,r)=>{let{typeKeywords:a}=e,i=(0,y.EN)(e),s=i===n.z.Collection,o=(0,y.WE)(e),m=(0,g.Y)({typeKeywords:a,typeKeywordId:w.hX.draft});return(s&&!m&&(a&&a.length&&(a.indexOf(w.hX.published)>=0||a.indexOf(w.hX.unpublishedChanges)>=0)?m=!1:"private"===e.access&&(m=!0)),i===n.z.Theme)?r?"builder":"create":"small"===t||"medium"===t?m&&!s?o?"preview-template":"preview":o?"viewer-template":"viewer":m&&r?o?"builder-template":"builder":o?"viewer-template":"viewer"},z=e=>{let{routeModifier:t,actionType:r,itemId:a,basePath:i}=e,s="view"===r?"":`/${r}`;return r.includes("new")?{href:`/${t}/${r}${a}`,asPath:`${i}/${t}${s}${a}`}:r.includes("check-issues")?{href:`/${t}/edit?id=${a}&checkIssues=true`,asPath:`${i}/${t}/${a}/edit?checkIssues=true`}:{href:`/${t}/${r}?id=${a}`,asPath:`${i}/${t}/${a}${s}`}};function P(e){let t=new URL(e).origin,r=e.match(/share\/([a-zA-Z0-9]{32})|id=([a-zA-Z0-9]{32})/),a=r?.[1]??r?.[2]??"",{hide:i,...s}={open:"web",hide:"navbar,footer,theme",embed:"fullScreen",...(0,c.gj)(e),id:a},o={...s,...i.includes("theme")&&window.location.origin.endsWith(".arcgis.com")?{version:"latest",jsApiVersion:"latest",host:encodeURIComponent(window.location.origin),embed:"jsapi"}:{}};return`${t}/share/?${(0,f.lK)(o)}&hide=${i}`}let F=({enableSurvey123AutoTheming:e=!0,...t})=>{let r=!!t.authManager&&t.authManager.username===t.item.owner,a=(0,p.yu)(t.portalHost,t.authManager);if(t.item.type===w.J6.Dashboard)return{href:`${a}/apps/dashboards/${t.item.id}`,asPath:""};if(t.item.type===w.J6.WebExperience)return t.isPortal?{href:`${a}/apps/experiencebuilder/experience/?id=${t.item.id}`,asPath:""}:{href:`https://experience${(0,T.oj)(t.portalHost)}.arcgis.com/experience/${t.item.id}`,asPath:""};if(t.item.type===w.J6.InsightsPage)return t.isPortal?{href:`${a}/apps/insights/#/embed/${t.item.id}`,asPath:""}:{href:`https://insights${(0,T.oj)(t.portalHost)}.arcgis.com/#/embed/${t.item.id}`,asPath:""};if(t.item.type===w.J6.VRExperience)return{href:`${a}/apps/360vr/index.html?id=${t.item.id}`,asPath:""};if(t.item.type!==h.tm&&t.item.type!==h.Jk&&t.item.url)return{href:(0,c.FB)(t.item.url),asPath:""};else if(t.item.type===w.J6.Image||t.item.type===w.J6.PDF)return{href:`${a}/sharing/rest/content/items/${t.item.id}/data`,asPath:""};else if(t.item.type===w.J6.Survey123){let r=`https://survey123${(0,T.oj)(t.portalHost)}.arcgis.com/share/${t.item.id}?portalUrl=${a}`;return{href:e?P(r):r,asPath:""}}return((e,t,r,a)=>{let{typeKeywords:i}=e,s=(0,y.EN)(e),o=s===n.z.Collection,m=(0,y.WE)(e),l=!!(i&&i.length&&i.indexOf(w.hX.draft)>=0);o&&!l&&(i&&i.length&&(i.indexOf(w.hX.published)>=0||i.indexOf(w.hX.unpublishedChanges)>=0)?l=!1:"private"===e.access&&(l=!0));let h=(e=>{let{isMobile:t,isDraft:r,isOwner:a,isCollection:i,isTheme:s}=e;return s?a?"edit":"new?theme=":t?r&&!i?"preview":"view":r&&a?"edit":"view"})({isDraft:l,isMobile:"small"===t||"medium"===t,isOwner:r,isCollection:o,isTheme:s===n.z.Theme}),d=(0,A.i)(s,m);return s!==n.z.Theme||r||(d="stories"),z({routeModifier:d,itemId:e.id,actionType:h,basePath:a})})(t.item,t.screenWidth,r,t.baseUrl)}}}]);